<UserControl x:Class="Rogue.NET.Scenario.Views.SkillGrid"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:coreView="clr-namespace:Rogue.NET.Core.View;assembly=Rogue.NET.Core"
             xmlns:commonView="clr-namespace:Rogue.NET.Common.View;assembly=Rogue.NET.Common"
             xmlns:scenarioConverter="clr-namespace:Rogue.NET.Scenario.Converter"
             xmlns:local="clr-namespace:Rogue.NET.Scenario.Views"
             xmlns:Microsoft_Windows_Themes="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Aero"
             xmlns:Dotway_WPF_Effects="clr-namespace:Dotway.WPF.Effects;assembly=Dotway.WPF.Effects">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/Rogue.NET.Scenario;component/Resources/Dictionaries/ItemGrid.xaml" />
                <ResourceDictionary Source="pack://application:,,,/Rogue.NET.Common;component/Resource/Dictionaries/RadioButton.xaml" />
                <ResourceDictionary Source="pack://application:,,,/Rogue.NET.Common;component/Resource/Dictionaries/ShinyTextButton.xaml" />
                <ResourceDictionary Source="pack://application:,,,/Rogue.NET.Core;component/Resource/Converter.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        
        <!-- Points Available -->
        <TextBlock HorizontalAlignment="Right" FontSize="16" Margin="4">
            <Run Text="Points: " />
            <Run Text="{Binding PointsAvailable}" />
        </TextBlock>
        
        <!-- Point Experience -->
        <commonView:ProgressBar BarColor1="Purple" Margin="4" Value="{Binding PointExperience}" ValueMax="{Binding PointExperienceNext}" />
        
        <!-- Skill Sets -->
        <ItemsControl ItemsSource="{Binding SkillSets}"
                      Margin="4">
            <ItemsControl.Template>
                <ControlTemplate>
                    <!-- Have to add a scroll viewer for the items -->
                    <ScrollViewer x:Name="ScrollViewer" Padding="{TemplateBinding Padding}">
                        <ItemsPresenter />
                    </ScrollViewer>
                </ControlTemplate>
            </ItemsControl.Template>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Border IsEnabled="{Binding IsLearned}">
                        <!-- Gray out if Skill Set not yet learned -->
                        <Border.Effect>
                            <Dotway_WPF_Effects:GrayscaleEffect DesaturationFactor="{Binding IsLearned, Converter={StaticResource BoolIntConverter}}"/>
                        </Border.Effect>
                        
                        <!-- Tooltip with Purple Smiley -->
                        <Border.ToolTip>
                            <ToolTip ToolTipService.IsEnabled="{Binding IsLearned, Converter={StaticResource BoolInverseConverter}}"
                                     Background="Transparent"
                                     BorderBrush="Transparent"
                                     Padding="0"
                                     Margin="0">
                                <Border Background="Black" Padding="10">
                                    <StackPanel Orientation="Horizontal">
                                        <coreView:Smiley SmileyColor="Purple" SmileyLineColor="Yellow" Width="20" Height="30" SmileyMood="Happy" SmileyRadius="3" />
                                        <StackPanel>
                                            <TextBlock Text="Skill is currently locked" Foreground="White" FontSize="14" Margin="4" />
                                            <TextBlock Foreground="LightBlue" FontSize="14" Margin="4">
                                                <Run Text="Required Level: " />
                                                <Run Text="{Binding LevelLearned}" />
                                            </TextBlock>
                                            <TextBlock Foreground="LightBlue" FontSize="14" Margin="4">
                                                <Run Text="Required Religion: " />
                                                <Run Text="{Binding ReligiousAffiliationRequirementName}" />
                                                <Run Text=" " />
                                                <Run Text="{Binding ReligiousAffiliationRequirementLevel, StringFormat=P0}" />
                                            </TextBlock>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </ToolTip>
                        </Border.ToolTip>
                        
                        <!-- Skill Set -->
                        <StackPanel Orientation="Horizontal">
                            
                            <!-- Symbol -->
                            <Image HorizontalAlignment="Left" VerticalAlignment="Center" Margin="4">
                                <Image.Source>
                                    <MultiBinding Converter="{StaticResource ScenarioImageSourceMultiConverter}">
                                        <Binding Path="Religion.CharacterSymbol" />
                                        <Binding Path="Religion.CharacterColor" />
                                        <Binding Path="Religion.Icon" />
                                        <Binding Path="Religion.DisplayIcon" />
                                        <Binding Path="Religion.SmileyMood" />
                                        <Binding Path="Religion.SmileyBodyColor" />
                                        <Binding Path="Religion.SmileyLineColor" />
                                        <Binding Path="Religion.SmileyAuraColor" />
                                        <Binding Path="Religion.SymbolType" />
                                    </MultiBinding>
                                </Image.Source>
                            </Image>

                            <!-- Name / Selected Skill Name -->
                            <TextBlock FontSize="18" Foreground="Tan" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="4">
                                <Run Text="{Binding RogueName}" />
                                <Run Text="/" />
                                <Run Text="{Binding SelectedSkill.RogueName}" />
                            </TextBlock>
                            
                            <!-- Button to Go-To Skill Screen -->
                            <TextBlock FontFamily="{StaticResource FontAwesome}" FontSize="20" Cursor="Hand" 
                                       VerticalAlignment="Center" Margin="4" Text="&#xf06e;" />
                            
                            <!-- Skill Selection Buttons -->
                            <StackPanel>
                                <Button FontFamily="{StaticResource FontAwesome}" FontSize="12" Cursor="Hand"
                                        Width="14" Height="14" Content="&#xf062;" Style="{StaticResource ShinyTextButtonStyle}" />
                                <Button FontFamily="{StaticResource FontAwesome}" FontSize="12" Cursor="Hand"
                                        Width="14" Height="14" Content="&#xf063;" Style="{StaticResource ShinyTextButtonStyle}" />
                            </StackPanel>
                            
                            <!-- Activate Button -->
                            <RadioButton GroupName="ActivateGroup" Height="18" Width="18" Cursor="Hand"
                                         Style="{StaticResource RadioButtonStyle}" VerticalAlignment="Center" />

                        </StackPanel>
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </Grid>
</UserControl>
